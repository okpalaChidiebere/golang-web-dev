  # buying a domain

https://domains.google/#/

# deploying to [Google Cloud](https://cloud.google.com/)
- [install google appengine](https://cloud.google.com/appengine/docs/go/download)
  - configure environment PATH variables
- google cloud developer console
  - create a project
  - get the project ID
- set your go version in the app.yaml file

```
runtime: go113
handlers:
- url: /.*
  script: auto
  secure: always
```
- deploy to that project. update --project with your project-id
```
gcloud app deploy app.yaml --project=<YOUR_PROJECT_ID>  -v 1
my example:
gcloud app deploy --project temp-137512
```
- view your project
  - http://YOUR_PROJECT_ID.appspot.com/


example
http://temp-145415.appspot.com/


change DNS info at google domains
point your domain to your appengine project


# deploying to [AWS Elastic Beanstalk](https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/go-tutorial.html)

First make sure your server is running fine locally and good to go!

- We will use EB CLI to deploy our application from our local machine. However, you can deploy from the console. So install EBCLI into your computer. I stalled from Homebrew using `brew install awsebcli` To verify that you have it installed run `eb --help`
- We then run `eb init` to generate a /.elasticbeanstalk/config.yaml file that EBS will use to create an application with our Elastic Beanstalk. Answer the question asked like location you want to deploy to, your application name, plaform you will run your code. These questions will help populate some values in the config file
- Add the config below to the config.yaml file generated by EB CLI. There are a few ways we can deploy our application. Read about the two methods for go apps (here)[https://markrichman.com/2017/02/17/aws-elastic-beanstalk-go/] but we are choosing the artifact method of deploying our app to EBS because we are building our app locally and we will package it in a single zip file which we will unpack on the server. The our server will run our code!

  ```yaml
  deploy:
    artifact: ./bin/Archive.zip
  ```
- (OPTIONAL) Run `eb init` again to configure a default key pair so that you can use SSH to connect to the EC2 instance running your application.
- We create a deployable build archive in a bin folder. The MakeFile below was what we used to pack together all the files necessary to run our static website like the index.html(A must), css files and images, and the main.go which MUST be names application.go if you want to deploy it to EBS. The go.mod file was optional for our app because we did not use any third part library in our app but i wanted to put it there anyways

```makefile
APP=bin/application
 
build: clean
	mkdir bin
	cp -rf css bin/css
	cp -rf img bin/img
	cp application.go bin/application.go
	cp -rf index.html bin/index.html
	cp go.mod bin/go.mod
	cd bin && zip -r Archive.zip .
	cd ..

clean:
	rm -rf bin/ || true
```
More resources about how to use makeFile (here)[https://danishpraka.sh/2019/12/07/using-makefiles-for-go.html]. Note that indentations are very important in makeFile formats to avoid errors. You misplace intentation for spaces with tab ket

- We then deploy our application the first time by running `eb create`. This command will create an environment where our infrastructure will be provisioned and run. This asks us a serios of questions like name of the environment (you can create multiple environment(dev, staging, prod) with different stages within an EBS application), Load balancer type(we choose application), CName. 

- For continuous depoyment all you need to run is eb deploy
- NOTE: Dont forget to set your environment variables in the EBS console if they are needed for your app to run. I think you can configure them in the config file. Check (this)[https://stackoverflow.com/questions/59020915/how-do-i-deploy-a-go-app-with-modules-to-aws-eb] out


For debugging purposes, if your app health is severe or not green, few reasons why it is not working is
- if you did not copy all the files needed to run your app correctlyinto the zip archive
- You have not yet set the environment variables in EBS after deploying your app locally to EBS
- You did not deploy the go app the correct way which is required by EBS for go apps. Eg not changing your main.go to application.go
- ** Feel free to check the eb logs aws well!


I did not commit the config.yaml file that EB CLI generated for us but the final copy looks like this
  ```yaml
  branch-defaults:
  default:
    environment: udemy-03-dev-dev
    group_suffix: null
  deploy:
    artifact: ./bin/Archive.zip
  global:
  application_name: udemy-02-dev
    branch: null
    default_ec2_keyname: some_KeyFile_name
    default_platform: Go 1 running on 64bit Amazon Linux 2
    default_region: my-location
    include_git_submodules: true
    instance_profile: null
    platform_name: null
    platform_version: null
    profile: null
    repository: null
    sc: null
    workspace_type: Application
  ```


You can terminatean Environment when you are done using `eb terminate`

VIDEO: What how to add custom domain name to your EBS (here)[https://www.youtube.com/watch?v=BeOKTpFsuvk]

VIDEO: How to set up Hosted Zone as well as set custom domain name for your cluster (here)[https://www.youtube.com/watch?v=TsVO14-lqp0]
